<!-- build time:Fri Apr 23 2021 13:07:21 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="专注技术分享" href="http://yrmlnf.coding-pages.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="专注技术分享" href="http://yrmlnf.coding-pages.com/atom.xml"><link rel="alternate" type="application/json" title="专注技术分享" href="http://yrmlnf.coding-pages.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="database"><link rel="canonical" href="http://yrmlnf.coding-pages.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93-%E4%B8%80%E4%BA%9B%E6%95%B0%E4%BB%93%E7%90%86%E8%AE%BA%E5%9C%A8%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%9A%84%E7%90%86%E8%A7%A3/"><title>数据仓库-一些数仓理论在工作中的理解 - 数据仓库 - 大数据 - 计算机科学 | Lucas Home = 专注技术分享 = 醒醒，别做梦了</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">数据仓库-一些数仓理论在工作中的理解</h1><div class="meta"><span class="item" title="创建时间：2020-04-04 15:42:43"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2020-04-04T15:42:43+08:00">2020-04-04</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>8.3k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>8 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Lucas Home</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva3.sinaimg.cn/large/005yAHGDly8gplgvgg14sj31hc0u0wk0.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/005yAHGDly8gplfduz9ikj31hc0u0gsu.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/005yAHGDly8gplfe7qim1j31hc0u0gye.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/005yAHGDly8gplgv96yqhj31hc0u0k2r.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/005yAHGDly8gplgus5sowj31hc0u0tgo.jpg"></li><li class="item" data-background-image="https://tva3.sinaimg.cn/large/005yAHGDly8gplgv6t7jkj31hc0u01eo.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" itemprop="item" rel="index" title="分类于 计算机科学"><span itemprop="name">计算机科学</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="item" rel="index" title="分类于 大数据"><span itemprop="name">大数据</span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/" itemprop="item" rel="index" title="分类于 数据仓库"><span itemprop="name">数据仓库</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://yrmlnf.coding-pages.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93-%E4%B8%80%E4%BA%9B%E6%95%B0%E4%BB%93%E7%90%86%E8%AE%BA%E5%9C%A8%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%9A%84%E7%90%86%E8%A7%A3/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Lucas"><meta itemprop="description" content="醒醒，别做梦了, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="专注技术分享"></span><div class="body md" itemprop="articleBody"><h1 id="数据仓库"><a class="anchor" href="#数据仓库">#</a> 数据仓库</h1><div class="note info"><p>数据仓库是一个面向主题的（Subject Oriented）、集成的（Integrate）、相对稳定的（Non-Volatile）、反映历史变化（Time Variant）的数据集合，它用于支持企业或组织的决策分析处理。用于支持决策，面向分析型数据处理，它不同于企业现有的操作型数据库；对多个异构的数据源有效集成，集成后按照主题进行了重组，并包含历史数据，而且存放在数据仓库中的数据一般不再修改</p></div><ul><li>面向主题：数据仓库是根据主题来建立的，数据仓库的主题指企业中某一宏观分析领域涉及的对象，也就是我们所设计事实表。</li><li>集成的：数据仓库的数据来源多样，有从业务数据库来的，有从文件系统来的，有基于消息中间件来的，所以我们需要对原有分散的数据库数据抽取、清理的基础上经过系统加工、汇总和整理得到的，必须消除源数据中的不一致性，以保证数据仓库内的信息是关于整个企业的一致的全局信息</li><li>相对稳定：数据仓库的数据用于支持上层决策分析之用，所涉及的数据主要用于查询，一旦数据进入某个数据仓库以后就会被保留下来，即从创建到删除的过程数据一般都是不会改变的。当数据改变后，不是进行 updae 而是 insert</li><li>反应历史变化：数据仓库中会保存各个日期节点的数据，以满足不断变化的业务的需求。</li></ul><h1 id="数据集市"><a class="anchor" href="#数据集市">#</a> 数据集市</h1><div class="note info"><p>数据集市就是满足特定的部门或者用户的需求，按照多维的方式进行存储，包括定义维度、需要计算的指标、维度的层次等，生成面向决策分析需求的数据立方体。数据集市通常被定义成星形结构，一办由一张事实表和几张维度表组成</p></div><p>数据集市就是数据仓库的子集，如需要分析的主题有供应商主题、商品主题、客户主题和仓库主题，这里就可以分为供应商集市，商品集市，客户集市，仓库集市，数据集市具有和数据仓库一样的特点。独立数据集市的存在会给人一种错觉，似乎可以先独立地构建数据集市，当数据集市达到一定的规模可以直接转换为数据仓库，，然而这是不正确的，多个独立的数据集市的累积并不能形成一个企业级的数据仓库，这是由数据仓库和数据集市本身的特点决定的。如果脱离集中式的数据仓库，独立的建立多个数据集市，企业只会又增加了一些信息孤岛，仍然不能以整个企业的视图分析数据，数据集市为各个部门或工作组所用，各个集市之间又会存在不一致性。至于是先建设数据集市还是先建设数据仓库，被人称为数据仓库界的宗教之争</p><h1 id="数据湖"><a class="anchor" href="#数据湖">#</a> 数据湖</h1><div class="note info"><p>数据湖 (Data Lake) 是 Pentaho 的 CTO James Dixon 提出来的 (Pentaho 作为一家 BI 公司在理念上是挺先进的)，是一种数据存储理念 —— 即在系统或存储库中以自然格式存储数据的方法。</p></div><p>数据湖就是数据仓库来源的容器。数据湖可以包括来自关系数据库（行和列）的结构化数据，半结构化数据（CSV，日志，XML，JSON），非结构化数据（电子邮件，文档，PDF）和二进制数据（图像，音频，视频）</p><h1 id="构建数仓步骤"><a class="anchor" href="#构建数仓步骤">#</a> 构建数仓步骤</h1><ol><li>确定主题：确定企业需要分析领域或前端展现的主题，例如：我们希望分析某年某月某一地区的商品销售情况，这就是一个主题。主题要体现出某一方面的各分析角度 (维度) 和统计数值型数据 (量度) 之间的关系，确定主题时要综合考虑</li><li>确定量度：确定主题后，我们要确定分析的指标数据。诸如年销售额之类。它们一般为数值型数据。我们或者将该数据汇总，或者将该数据取次数、独立次数或取最大最小值等，这样的数据称为量度。量度是要统计的指标，必须事先选择恰当，基于不同的量度可以进行复杂关键性能指标 (KPI) 等的设计和计算。</li><li>确定粒度：在确定了量度之后，我们要考虑到该量度的汇总情况和不同维度下量度的聚合情况。考虑到量度的聚合程度不同，我们将采用 “最小粒度原则”，即将量度的粒度设置到最小。例如：假设目前的数据最小记录到秒，即数据库中记录了每一秒的交易额。那么，如果我们可以确认，在将来的分析需求中，时间只需要精确到天就可以的话，我们就可以在 ETL 处理过程中，按天来汇总数据，此时，数据仓库中量度的粒度就是 “天”; 反过来，如果我们不能确认将来的分析需求在时间上是否需要精确到秒，那么，我们就需要遵循 “最小粒度原则”，在数据仓库的事实表中保留每一秒的数据，以便日后对 “秒” 进行分析。在采用 “最小粒度原则” 的同时，我们不必担心海量数据所带来的汇总分析效率问题，因为在后续建立多维分析模型 (CUBE) 的时候，我们会对数据提前进行汇总，从而保障产生分析结果的效率。</li><li>确定维度：维度是指分析主题不同角度，列如分析某年某月某一地区的商品销售情况，时间与地区就是两个不同的维度，我可以分别建立维度表</li><li>确定事实表：事实表由维度主键和量度数值 (计算域) 组成。如果以商品销售额为主题，那么他可能就有时间维度表与地区维度表的 ID 字段与销售数量，销售金额，销售利润等计算域。</li></ol><h2 id="inmon开发方式"><a class="anchor" href="#inmon开发方式">#</a> Inmon 开发方式</h2><div class="note info"><p>Inmon 模式从流程上看是自顶向下的，即从数据源到数据仓库再到数据集市一种瀑布流的开发方式。对于 Inmon，数据源往往是异构的，主要的数据处理工作集中在数据清洗，数据校验与入库。在这种场景下，数据无法直接从存储层进到 DM 层，必须先通过 ETL 将数据清洗后变成实体 - 关系模型放入 DW 层，再由 DW 层生成事实表与维度表输出到 DM 层。</p></div><h3 id="开发流程"><a class="anchor" href="#开发流程">#</a> 开发流程</h3><p>通常，Inmon 都是以数据源为导向。首先，需要探索性地去获取尽量符合预期的数据，尝试将数据按照预期划分为不同的表需求。其次，明确了数据的清洗规则后通过 ETL 生成实体 - 关系由存储层转换位 dw 层。接着，在完成 DW 的数据治理之后，通过 ETL 将实体 - 关系模型转化为事实表与维度表输出到 DM 层，最后 DM 层位为上层应用提供数据<br><img data-src="1.png" alt=""></p><h2 id="kimball开发方式"><a class="anchor" href="#kimball开发方式">#</a> Kimball 开发方式</h2><div class="note info"><p>Kimball 模式从流程上看是自底向上的，即从数据集市到数据仓库再到数据源的一种敏捷开发方式。对于 Kimball 模式，数据源往往是给定的若干个数据库表，数据较为稳定但是数据之间的关联关系比较复杂，需要从这些 OLTP 中产生的事务型数据结构抽取出分析型数据结构，再放入数据集市中方便下一步的 BI 与决策支持</p></div><h3 id="开发流程-2"><a class="anchor" href="#开发流程-2">#</a> 开发流程</h3><p>通常，Kimball 以最终任务为导向。首先，在得到数据后先做数据的探索，尝试将数据按照目标先拆分出不同的表需求。其次，在明确数据依赖后将各个任务再通过 ETL 生成事实表与维度表放到 DM 层。接着，在完成 DM 层的事实表维度表拆分后，数据集市一方面可以直接向 BI 环节输出数据了，另一方面可以先 DW 层输出数据，方便后续的多维分析。<br><img data-src="2.png" alt=""></p><h2 id="inmon-vs-kimball"><a class="anchor" href="#inmon-vs-kimball">#</a> Inmon vs Kimball</h2><h3 id="特性"><a class="anchor" href="#特性">#</a> 特性</h3><table><thead><tr><th>特性</th><th>Kimball</th><th>Inmon</th></tr></thead><tbody><tr><td>数据摄取</td><td>yes</td><td>yes</td></tr><tr><td>stage</td><td>yes</td><td>yes</td></tr><tr><td>ETL</td><td>yes</td><td>yes</td></tr><tr><td>数据集市</td><td>yes</td><td>yes</td></tr><tr><td>商业需求</td><td>yes</td><td>yes</td></tr><tr><td>数据时间属性</td><td>yes</td><td>yes</td></tr><tr><td>数据仓库优先</td><td>no</td><td>yes</td></tr><tr><td>事实维度拆分</td><td>yes</td><td>no</td></tr><tr><td>关系表维护</td><td>no</td><td>yes</td></tr><tr><td>处理导向</td><td>yes</td><td>no</td></tr><tr><td>数据模型泛化</td><td>no</td><td>yes</td></tr><tr><td>精心设计</td><td>no</td><td>yes</td></tr><tr><td>缓慢变化维</td><td>yes</td><td>no</td></tr><tr><td>连续变化维</td><td>no</td><td>yes</td></tr></tbody></table><h3 id="优劣比较"><a class="anchor" href="#优劣比较">#</a> 优劣比较</h3><table><thead><tr><th>特性</th><th>Kimball</th><th>Inmon</th></tr></thead><tbody><tr><td>时间</td><td>快速交付</td><td>路漫漫其修远兮</td></tr><tr><td>开发难度</td><td>小</td><td>大</td></tr><tr><td>维护难度</td><td>大</td><td>小</td></tr><tr><td>技能要求</td><td>入门级</td><td>专家级</td></tr><tr><td>数据要求</td><td>特定业务</td><td>企业级</td></tr></tbody></table><h3 id="具体例子"><a class="anchor" href="#具体例子">#</a> 具体例子</h3><p>股票交易为例：<br>（OLTP）原始数据包含了如下几张事务表：(真实场景字段设计更为复杂，此处已经简化)</p><table><thead><tr><th>交易记录 ID</th><th>用户 ID</th><th>交易 ID</th><th>交易单号</th><th>标的 CODE</th><th>出价</th><th>现价</th><th>方向</th><th>手数</th><th>创建时间</th><th>修改时间</th><th>状态</th><th>备注</th><th>类型</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>1</td><td>MR123456</td><td>A123456</td><td>9.0</td><td>9.5</td><td>买</td><td>100</td><td>2016-10-10 10:58:00</td><td>2016-10-10 10:58:00</td><td>未成交</td><td>NULL</td><td>创业板</td></tr><tr><td>2</td><td>1</td><td>1</td><td>MR123456</td><td>A123456</td><td>9.0</td><td>8.9</td><td>买</td><td>200</td><td>2016-10-10 11:00:00</td><td>2016-10-10 11:00:10</td><td>已成交</td><td>NULL</td><td>创业板</td></tr><tr><td>3</td><td>1</td><td>2</td><td>MR123457</td><td>A123456</td><td>10.1</td><td>10.2</td><td>卖</td><td>200</td><td>2016-10-10 14:00:00</td><td>2016-10-10 14:00:30</td><td>已成交</td><td>NULL</td></tr></tbody></table><p>成交日志表：记录用户下单且成交的情况</p><table><thead><tr><th>成交日志 ID</th><th>用户 ID</th><th>外部单号</th><th>交易记录 ID</th><th>标的 CODE</th><th>方向</th><th>手数</th><th>成交价格</th><th>创建时间</th><th>修改时间</th><th>状态</th><th>备注</th><th>类型</th></tr></thead><tbody><tr><td>1</td><td>1</td><td>MR123456</td><td>2</td><td>A123456</td><td>买</td><td>200</td><td>8.9</td><td>2016-10-10 11:00:10</td><td>2016-10-10 11:00:10</td><td>正常</td><td>NULL</td><td>创业板</td></tr><tr><td>2</td><td>1</td><td>MR123456</td><td>3</td><td>A123456</td><td>卖</td><td>200</td><td>10.1</td><td>2016-10-10 14:00:30</td><td>2016-10-10 14:00:30</td><td>正常</td><td>NULL</td><td>创业板</td></tr></tbody></table><p>用户信息表</p><table><thead><tr><th>用户 ID</th><th>别名</th><th>姓名</th><th>联系方式</th><th>性别</th><th>身份号码</th><th>资产账户 ID</th><th>是否开通创业板</th><th>风险评级</th><th>资产余额</th><th>创建时间</th><th>修改时间</th><th>用户类型</th><th>资产类型</th></tr></thead><tbody><tr><td>1</td><td>FinanceR</td><td>张三</td><td>1234567890</td><td>女</td><td>12345567890X</td><td>SA123213</td><td>是</td><td>高</td><td>12321312.00</td><td>2015-10-10 14:00:00</td><td>2016-10-10 14:00:00</td><td>A</td><td>现金账户</td></tr></tbody></table><h4 id="inmon模式"><a class="anchor" href="#inmon模式">#</a> Inmon 模式</h4><p>如果是 Inmon 模式，我们需要将数据库拆分成 用户实体表、成交日志实体表、用户与成交日志关系表等多个子模块。</p><p>用户实体表</p><table><thead><tr><th>用户 ID</th><th>别名</th><th>姓名</th><th>联系方式</th><th>性别</th><th>身份号码</th><th>是否开通创业板</th><th>风险评级</th><th>资产余额</th><th>创建时间</th><th>修改时间</th><th>用户类型</th><th>资产类型</th></tr></thead><tbody><tr><td>1</td><td>FinanceR</td><td>张三</td><td>1234567890</td><td>女</td><td>12345567890X</td><td>是</td><td>高</td><td>12321312.00</td><td>2015-10-10 14:00:00</td><td>2016-10-10 14:00:00</td><td>A</td><td>现金账户</td></tr></tbody></table><p>成交关系表</p><table><thead><tr><th>成交 ID</th><th>用户 ID</th></tr></thead><tbody><tr><td>1</td><td>1</td></tr><tr><td>2</td><td>1</td></tr></tbody></table><p>用户资产关系表</p><table><thead><tr><th>资产 ID</th><th>- 用户 ID</th></tr></thead><tbody><tr><td>SA123213</td><td>-1</td></tr></tbody></table><h4 id="kimball-模式"><a class="anchor" href="#kimball-模式">#</a> Kimball 模式</h4><p>如果是 Kimball 模式，我们则需要将数据库拆分成 用户维度表、用户资产事实表、成交事实表。在 Kimball 模式中，我们不需要单独维护关系表，因为关系已经冗余在维度表和事实表中。</p><p>用户维度表</p><table><thead><tr><th>用户 ID</th><th>别名</th><th>姓名</th><th>联系方式</th><th>性别</th><th>身份号码</th><th>是否创业板</th><th>风险评级 ID</th><th>创建时间</th><th>修改时间</th><th>用户类型 ID</th><th>资产 ID</th></tr></thead><tbody><tr><td>1</td><td>FinanceR</td><td>张三</td><td>1234567890</td><td>女</td><td>SA123213</td><td>1</td><td>1</td><td>2015-10-10 14:00:00</td><td>2016-10-10 14:00:00</td><td>1</td><td>SA123213</td></tr></tbody></table><p>可以看到这里的用户维度表不包含业务交易信息，变化相对缓慢（静态）而风险评级、用户类型也需要由风险评级维度表、用户类型维度表来维护</p><p>用户资产事实表</p><table><thead><tr><th>资产 ID</th><th>用户 ID</th><th>账户余额</th><th>资产类型</th><th>创建时间</th><th>修改时间</th></tr></thead><tbody><tr><td>SA123213</td><td>1</td><td>12321312.00</td><td>现金账户</td><td>2016-10-10 14:00:00</td><td>2016-10-10 14:00:00</td></tr></tbody></table><p>这里的用户资产事实表通常数据是由用户资产交易日志产生的，因为日志存在只插入，不更新的特点（快速增加、最细粒度）</p><h4 id="总结"><a class="anchor" href="#总结">#</a> 总结</h4><ul><li>对于大多数互联网公司由于需求的快速变化，处心积虑设计（Inmon）实体 - 关系的设计哲学似乎并不能满足快速迭代的业务需要。所以，更多场景下趋向于使用（Kimball）维度 - 事实的设计哲学反而可以更快地完成任务。</li><li>数据仓库建设通常以日为粒度，将 OLTP 数据变化的不情况增量同步到数据仓库中。</li><li>在数据仓库的实际工作中，80% 的时间会花费在任务调度、数据清洗和业务梳理上，只有 20% 的时间会投入到数据挖掘上。</li></ul><h2 id="数据仓库分层"><a class="anchor" href="#数据仓库分层">#</a> 数据仓库分层</h2><p>不同项目按照实际分层，项目可能有 2-5 层，按实际来决定</p><h3 id="ods层"><a class="anchor" href="#ods层">#</a> ODS 层</h3><p>功能：ODS 层是数据仓库准备区，为 DWD 层提供基础原始数据，可减少对业务系统的影响<br>建模方式及原则：从业务系统增量抽取、保留时间由业务需求决定、可分表进行周期存储、数据不做清洗转换与业务系统数据模型保持一致、按主题逻辑划分</p><h3 id="dwd-数据明细层"><a class="anchor" href="#dwd-数据明细层">#</a> DWD 数据明细层</h3><p>功能：为 DW 层提供来源明细数据，提供业务系统细节数据的长期沉淀，为未来分析类需求的扩展提供历史数据支撑<br>建模方式及原则：数据模型与 ODS 层一致，做轻度的清洗转换处理，按年月日进行分表、用增量 ODS 层数据和前一天 DWD 相关表进行 merge 处理</p><h3 id="dws-数据汇总层"><a class="anchor" href="#dws-数据汇总层">#</a> DWS 数据汇总层</h3><p>功能：服务数据层，基于 DWD 上的基础数据，主要整合汇总最终的结果供应用层使用，一般是宽表和高度压缩表。<br>建模方式及原则：对 DWD 进行脱敏，清洗转换，建立事实表维度表，增加派生事实。</p><h3 id="dm-数据应用层"><a class="anchor" href="#dm-数据应用层">#</a> DM 数据应用层</h3><p>功能：为上层应用提供查询数据<br>建模方式及原则：保持数据量小，增加数据业务日期字段，支持数据重跑</p><h3 id="其他"><a class="anchor" href="#其他">#</a> 其他</h3><table><thead><tr><th>名词</th><th>名词简称</th><th>名词解释</th></tr></thead><tbody><tr><td>Data Warehouse</td><td>DW</td><td>数据仓库主体</td></tr><tr><td>Operational Data Store</td><td>ODS</td><td>数据原始接入层，需要对数据频繁的增删改查，是支持对近期数据的 OLTP 查询，以减轻业务系统负载。</td></tr><tr><td>Data Warehouse Detail</td><td>DWD</td><td>数据源的细节层，有的也称为 ODS 层，是业务层与数据仓库的隔离层，在该层可以把业务表分的更细</td></tr><tr><td>Data Warehouse Base</td><td>DWB</td><td>数据仓库基础数据层，存储的是客观数据，一般用作中间层，可以认为是大量指标的数据层</td></tr><tr><td>Data Warehouse Service</td><td>DWS</td><td>服务数据层，基于 DWB 上的基础数据，主要整合汇总最终的结果供应用层使用，一般是宽表和高度压缩表。</td></tr><tr><td>Data Warehouse History</td><td>DWH</td><td>该层不在数据仓库设计的范围之内，按照业务新增的数据层，主要储存历史数据。</td></tr><tr><td>Data Warehouse Exception</td><td>DWE</td><td>该层不在数据仓库设计的范围之内，按照业务新增的数据层，主要储存异常数据。</td></tr><tr><td>Enterprise Data Warehouse</td><td>EDW</td><td>作为企业唯一的数据仓库，EDW 提供统一的数据服务，查询结果有效一致。数据设计支持跨部门，支持海量数据，并支持大量的查询请求。</td></tr><tr><td>Data Mart</td><td>DM</td><td>和 EDW 类似，但更专注于部门级别而不是公司级别的统一数据服务。提供 EDW 不能提供的，针对部门的特殊数据服务需求</td></tr><tr><td>BI/Analytic Database</td><td>BID/AD</td><td>为商业智能和分析而优化的数据处理技术。包括数据清理，ETL, 数据挖掘等。生产报表，也支持 adhoc 查询，数据反范式设计。</td></tr><tr><td>Data Lake Database</td><td>DLD</td><td>该层存储非加工数据，比如日志、视频等，以后结构化数据，并且不分类，没有为了特定程序进行设计和加工。</td></tr></tbody></table><h1 id="代理键与自然键"><a class="anchor" href="#代理键与自然键">#</a> 代理键与自然键</h1><ul><li>自然键：由现实世界中已经存在的属性组成的键。比如身份证号是由政府颁发的并且每个人都是唯一的，这是一个已经存在的自然键</li><li>代理键：不具有业务含义的键，常见的自增主键</li></ul><h1 id="事实表"><a class="anchor" href="#事实表">#</a> 事实表</h1><blockquote><p>事实表的设计完全依赖于物理活动，不受可能产生的最终报表的影响。除了数字度量外，事实表总是包含外键，用于关联与之对应的维度，也包含可选的退化维度建和日期 / 时间戳。查询请求的主要目标是基于事实表开展计算和聚集操作。</p></blockquote><h2 id="事实表分类"><a class="anchor" href="#事实表分类">#</a> 事实表分类</h2><p>事实用于度量业务过程。按度量来分有三种类型：</p><ul><li>可加性事实：事实表在任何维度都是可以进行汇总</li><li>半可加性事实：半可加性事实只能按照特定的维度汇总，不能对所有的维度汇总。例如库存可以按照地点和商品进行汇总，而按照时间维度把一年中每个月的库存累积加起来毫无意义</li><li>不可加性事实：事实表在任何维度都不难汇总</li></ul><p>按生产方法也可分为以下三种</p><ul><li>事务事实表（Transaction fact table）：也叫原子事实表，描述业务过程。数据一旦插入不再更改，其更新方式为增量更新。事务事实表的日期维度记录的是事务发生的日期，例如交易事实表</li><li>周期快照事实表（Periodicsnapshot fact table）：周期快照事实表以具有规律性的、可预见的时间间隔来记录事实，时间间隔如每天、每月、每年等等。周期事实表一般拥有规律的周期，其更新方式为增量更新。典型的例子如销售日快照表、库存日快照表等。周期事实表的日期维度记录的是统计的截止日期。</li><li>累积快照事实表：如果说周期快照事实表记录的确定的周期的数据，那累积快照事实表记录的不确定的周期的数据。它通常具有多个日期字段，用来记录整个生命周期中的关键时间点。<br>例如事务事实表，每天都会有一条记录来记录交易过程</li></ul><table><thead><tr><th>日期</th><th>订单 ID</th><th>下单时间</th><th>支付日期</th><th>确认收货日期</th></tr></thead><tbody><tr><td>20200401</td><td>1</td><td>2020/04/01 11:00</td><td>null</td><td>null</td></tr><tr><td>20200402</td><td>1</td><td>2020/04/01 11:00</td><td>2020/04/02 12:00</td><td>null</td></tr><tr><td>20200403</td><td>1</td><td>2020/04/01 11:00</td><td>2020/04/03 13:00</td><td>null</td></tr></tbody></table><p>而累积快照事实表只会有一条记录，数据会一致更新直到过程结束。</p><table><thead><tr><th>日期</th><th>订单 ID</th><th>下单时间</th><th>支付日期</th><th>确认收货日期</th></tr></thead><tbody><tr><td>20200401</td><td>1</td><td>2020/04/01 11:00</td><td>2020/04/02 12:00</td><td>2020/04/03 13:00</td></tr></tbody></table><p>如果事实表的计算域是需要汇总的并且具有周期性的，如库存主题，销售主题，工单主题则使用周期快照事实表，否则选事务事实表或累积快照事实表</p><h2 id="事实表中的空值"><a class="anchor" href="#事实表中的空值">#</a> 事实表中的空值</h2><p>事实表中可以存在空值度量，但是在事实表的外键中不能存在空值，否则会导致违反参照完整性的情况发生</p><h1 id="维度表"><a class="anchor" href="#维度表">#</a> 维度表</h1><p>度量为 “事实”，维度为 “环境”。维度用于描述事实发生的多样环境，可以用来约束查询、分类汇总以及排序。维度通常用主键来标识其唯一性。主键有两种：具有业务含义的自然键以及自增列或全局唯一标识的代理键。</p><h2 id="维度变化"><a class="anchor" href="#维度变化">#</a> 维度变化</h2><p>数仓的重要特点是要反映历史变化，所以如何处理维度的变化是维度设计的重点工作。对于缓慢变化维，通常有如下三种处理方法：</p><ul><li>重写维度值：当维度发生变化时更新维度的值</li><li>插入新的维度行：当维度发生变化时不是更新旧的维度值，而是插入一条新的维度数据，并且用版本号或其他字段加以区分</li><li>添加维度列：用新的列来保存新的维度数据</li></ul><h2 id="退化维度"><a class="anchor" href="#退化维度">#</a> 退化维度</h2><div class="note info"><p>退化维 (Degenerate Dimensions) 的定义是 Ralph Kimball 提出来的。一般来说事实表中的外键都对应一个维表，维的信息主要存放在维表中；但是退化维仅仅是事实表中的一列，这个维的相关信息都在这一 列中，没有维表与之相关联。比如：发票号，序列号等等</p></div><p>这种退化维度一般都是事务的编号，如订单编号、发票编号等。这类字段量级很大，没必要用一张维度表来存储，而是冗余到事实表中，但是不需要对应的维度表，所以称为退化维度。<br>退化维度有下面三个优点</p><ul><li>退化维具有普通维的各种操作，比如：上卷，切片，切块等。</li><li>存在退化维，ETL 会变得容易</li><li>可以让 group by 更快</li></ul><h2 id="杂项维度"><a class="anchor" href="#杂项维度">#</a> 杂项维度</h2><p>事务性商业过程通常产生一系列混杂的，低粒度的标识和指示器，与其为每个标识或属性定义不同的维度，不如建立单独的将不同维度合并到一起的杂项维度。这些维度，通常在一个模式中标记为事务性概要维度，不需要所有属性可能值的笛卡尔积，但应该只包含实际发生在源数据中的合并值</p><h1 id="上卷和下钻"><a class="anchor" href="#上卷和下钻">#</a> 上卷和下钻</h1><ul><li>上卷 (Roll-up)：上卷是沿着维的层次向上聚集汇总数据。例如，对产品销售数据，沿着时间维上卷，可以求出所有产品在所有地区每月（或季度或年或全部）的销售额。</li><li>下钻（Drill-down）: 下探是上卷的逆操作，它是沿着维的层次向下，查看更详细的数据</li></ul><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span> <span class="token keyword">group</span> <span class="token keyword">by</span> A；</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span> <span class="token keyword">group</span> <span class="token keyword">by</span> A<span class="token punctuation">,</span>B；</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token keyword">table</span> <span class="token keyword">group</span> <span class="token keyword">by</span> A<span class="token punctuation">,</span>B<span class="token punctuation">,</span>C；</pre></td></tr><tr><td data-num="4"></td><td><pre>自上而下粒度变细，为下钻；</pre></td></tr><tr><td data-num="5"></td><td><pre>自下而上粒度变粗，为上卷</pre></td></tr></table></figure><h1 id="数据建模"><a class="anchor" href="#数据建模">#</a> 数据建模</h1><p>数据建模 (Data modeling) 是为要存储在数据库中的数据创建数据模型的过程。数据建模在概念上包括以下 3 个部分：</p><ul><li>数据对象 (Data objects)</li><li>不同数据对象之间的关联 (The associations between different data objects)</li><li>规则 (The rules)</li></ul><h2 id="星型模型"><a class="anchor" href="#星型模型">#</a> 星型模型</h2><p>当所有维表都直接连接到 “事实表” 上时，整个图解就像星星一样，故将该模型称为星型模型</p><p><img data-src="3.png" alt=""></p><p>星型架构是一种非正规化的结构，多维数据集的每一个维度都直接与事实表相连接<br>优点：</p><ul><li>效率高：星型模型因为数据的冗余所以很多统计查询不需要做外部的连接，因此一般情况下效率比雪花型模型要高</li><li>ETL 较为容易：星型结构不用考虑很多正规化的因素，设计与实现都比较简单，每个维度都不会有外键再与其他维度表关联。</li></ul><p>缺点</p><ul><li>数据冗余高：星型模型会在把数据直接冗余在维度表里，如在地域维度表中，存在国家 A 省 B 的城市 C 以及国家 A 省 B 的城市 D 两条记录，那么国家 A 和省 B 的信息分别存储了两次。</li></ul><h2 id="雪花模型"><a class="anchor" href="#雪花模型">#</a> 雪花模型</h2><p>雪花模型是对星型模型的扩展。它对星型模型的维表进一步层次化，原有的各维表可能被扩展为小的事实表，形成一些局部的 &quot;层次&quot; 区域，这些被分解的表都连接到主维度表而不是事实表。</p><p><img data-src="4.png" alt=""></p><p>优点：</p><ul><li>数据冗余低：雪花模型更加符合数据库范式，如在地域维度表中，雪花模型会拆分为国家维度，省维度，城市维度，因而数据冗余也会变少</li></ul><p>缺点：</p><ul><li>效率较低：在分析数据的时候，操作比较复杂，需要 join 的表比较多所以其性能比星型模型差一点</li><li>ETL 较为复杂：在进行 ETL 的时候，雪花模型需要关联查询的表比较多，ETL 逻辑将会比较复杂</li></ul><h2 id="星座模型"><a class="anchor" href="#星座模型">#</a> 星座模型</h2><p>由多个事实表组合，维表是公共的，可以被多个事实表共享。星座模型是数据仓库最常使用的模型。</p><p><img data-src="5.png" alt=""></p><h2 id="三种模式对比"><a class="anchor" href="#三种模式对比">#</a> 三种模式对比</h2><p><img data-src="6.png" alt=""></p><div class="tags"><a href="/tags/database/" rel="tag"><i class="ic i-tag"></i> database</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2021-04-23 11:07:15" itemprop="dateModified" datetime="2021-04-23T11:07:15+08:00">2021-04-23</time> </span><span id="计算机科学/大数据/数据仓库/数据仓库-一些数仓理论在工作中的理解/" class="item leancloud_visitors" data-flag-title="数据仓库-一些数仓理论在工作中的理解" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Lucas 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="Lucas 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="Lucas 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Lucas <i class="ic i-at"><em>@</em></i>专注技术分享</li><li class="link"><strong>本文链接：</strong> <a href="http://yrmlnf.coding-pages.com/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93-%E4%B8%80%E4%BA%9B%E6%95%B0%E4%BB%93%E7%90%86%E8%AE%BA%E5%9C%A8%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%9A%84%E7%90%86%E8%A7%A3/" title="数据仓库-一些数仓理论在工作中的理解">http://yrmlnf.coding-pages.com/计算机科学/大数据/数据仓库/数据仓库-一些数仓理论在工作中的理解/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E8%BD%AF%E4%BB%B6%E5%BA%94%E7%94%A8/Github-%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;005yAHGDly8gplgvgg14sj31hc0u0wk0.jpg" title="Github-部署静态页面"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> 软件应用</span><h3>Github-部署静态页面</h3></a></div><div class="item right"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Pentaho-CDE%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;005yAHGDly8gplgu18wz2j31hc0u0497.jpg" title="Pentaho-CDE开发指南"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 数据可视化</span><h3>Pentaho-CDE开发指南</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93"><span class="toc-number">1.</span> <span class="toc-text">数据仓库</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%9B%86%E5%B8%82"><span class="toc-number">2.</span> <span class="toc-text">数据集市</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B9%96"><span class="toc-number">3.</span> <span class="toc-text">数据湖</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E6%95%B0%E4%BB%93%E6%AD%A5%E9%AA%A4"><span class="toc-number">4.</span> <span class="toc-text">构建数仓步骤</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#inmon%E5%BC%80%E5%8F%91%E6%96%B9%E5%BC%8F"><span class="toc-number">4.1.</span> <span class="toc-text">Inmon 开发方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B"><span class="toc-number">4.1.1.</span> <span class="toc-text">开发流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#kimball%E5%BC%80%E5%8F%91%E6%96%B9%E5%BC%8F"><span class="toc-number">4.2.</span> <span class="toc-text">Kimball 开发方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E6%B5%81%E7%A8%8B-2"><span class="toc-number">4.2.1.</span> <span class="toc-text">开发流程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#inmon-vs-kimball"><span class="toc-number">4.3.</span> <span class="toc-text">Inmon vs Kimball</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E6%80%A7"><span class="toc-number">4.3.1.</span> <span class="toc-text">特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E5%8A%A3%E6%AF%94%E8%BE%83"><span class="toc-number">4.3.2.</span> <span class="toc-text">优劣比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E4%BE%8B%E5%AD%90"><span class="toc-number">4.3.3.</span> <span class="toc-text">具体例子</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#inmon%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.3.3.1.</span> <span class="toc-text">Inmon 模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#kimball-%E6%A8%A1%E5%BC%8F"><span class="toc-number">4.3.3.2.</span> <span class="toc-text">Kimball 模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.3.3.3.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93%E5%88%86%E5%B1%82"><span class="toc-number">4.4.</span> <span class="toc-text">数据仓库分层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ods%E5%B1%82"><span class="toc-number">4.4.1.</span> <span class="toc-text">ODS 层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dwd-%E6%95%B0%E6%8D%AE%E6%98%8E%E7%BB%86%E5%B1%82"><span class="toc-number">4.4.2.</span> <span class="toc-text">DWD 数据明细层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dws-%E6%95%B0%E6%8D%AE%E6%B1%87%E6%80%BB%E5%B1%82"><span class="toc-number">4.4.3.</span> <span class="toc-text">DWS 数据汇总层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dm-%E6%95%B0%E6%8D%AE%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">4.4.4.</span> <span class="toc-text">DM 数据应用层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-number">4.4.5.</span> <span class="toc-text">其他</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A3%E7%90%86%E9%94%AE%E4%B8%8E%E8%87%AA%E7%84%B6%E9%94%AE"><span class="toc-number">5.</span> <span class="toc-text">代理键与自然键</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8B%E5%AE%9E%E8%A1%A8"><span class="toc-number">6.</span> <span class="toc-text">事实表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%AE%9E%E8%A1%A8%E5%88%86%E7%B1%BB"><span class="toc-number">6.1.</span> <span class="toc-text">事实表分类</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%AE%9E%E8%A1%A8%E4%B8%AD%E7%9A%84%E7%A9%BA%E5%80%BC"><span class="toc-number">6.2.</span> <span class="toc-text">事实表中的空值</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%B4%E5%BA%A6%E8%A1%A8"><span class="toc-number">7.</span> <span class="toc-text">维度表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%B4%E5%BA%A6%E5%8F%98%E5%8C%96"><span class="toc-number">7.1.</span> <span class="toc-text">维度变化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%80%E5%8C%96%E7%BB%B4%E5%BA%A6"><span class="toc-number">7.2.</span> <span class="toc-text">退化维度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%82%E9%A1%B9%E7%BB%B4%E5%BA%A6"><span class="toc-number">7.3.</span> <span class="toc-text">杂项维度</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8A%E5%8D%B7%E5%92%8C%E4%B8%8B%E9%92%BB"><span class="toc-number">8.</span> <span class="toc-text">上卷和下钻</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1"><span class="toc-number">9.</span> <span class="toc-text">数据建模</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%9F%E5%9E%8B%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.1.</span> <span class="toc-text">星型模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9B%AA%E8%8A%B1%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.2.</span> <span class="toc-text">雪花模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%9F%E5%BA%A7%E6%A8%A1%E5%9E%8B"><span class="toc-number">9.3.</span> <span class="toc-text">星座模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E6%A8%A1%E5%BC%8F%E5%AF%B9%E6%AF%94"><span class="toc-number">9.4.</span> <span class="toc-text">三种模式对比</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93-%E4%B8%80%E4%BA%9B%E6%95%B0%E4%BB%93%E7%90%86%E8%AE%BA%E5%9C%A8%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%9A%84%E7%90%86%E8%A7%A3/" rel="bookmark" title="数据仓库-一些数仓理论在工作中的理解">数据仓库-一些数仓理论在工作中的理解</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Lucas" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Lucas</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">26</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">11</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">29</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3lvdXJuYW1l" title="https:&#x2F;&#x2F;github.com&#x2F;yourname"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPXlvdXJpZA==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;yourid"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20veW91cm5hbWU=" title="https:&#x2F;&#x2F;weibo.com&#x2F;yourname"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E8%BD%AF%E4%BB%B6%E5%BA%94%E7%94%A8/Github-%E9%83%A8%E7%BD%B2%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Pentaho-CDE%E5%BC%80%E5%8F%91%E6%8C%87%E5%8D%97/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/" title="分类于 数据仓库">数据仓库</a></div><span><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93/%E6%95%B0%E6%8D%AE%E4%BB%93%E5%BA%93-%E4%B8%80%E4%BA%9B%E6%95%B0%E4%BB%93%E7%90%86%E8%AE%BA%E5%9C%A8%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%9A%84%E7%90%86%E8%A7%A3/" title="数据仓库-一些数仓理论在工作中的理解">数据仓库-一些数仓理论在工作中的理解</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/IT%E8%BF%90%E7%BB%B4/" title="分类于 IT运维">IT运维</a></div><span><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/IT%E8%BF%90%E7%BB%B4/MySQL-%E5%9C%A8%E5%90%84%E7%B3%BB%E7%BB%9F%E4%B8%8B%E5%AE%89%E8%A3%85/" title="MySQL-在各系统下安装">MySQL-在各系统下安装</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a></div><span><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-TreeMap%E7%BA%A2%E9%BB%91%E6%A0%91/" title="数据结构-TreeMap红黑树">数据结构-TreeMap红黑树</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a></div><span><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-B%E6%A0%91%E3%80%81B-%E6%A0%91%E3%80%81B-%E6%A0%91/" title="数据结构-B树、B-树、B-树">数据结构-B树、B-树、B-树</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="分类于 数据库">数据库</a></div><span><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E5%BA%93/Redis-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E4%B8%8E%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" title="Redis-基本概念与解决方案">Redis-基本概念与解决方案</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/" title="分类于 网络爬虫">网络爬虫</a></div><span><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB/PySpider-%E7%88%AC%E5%8F%96Shopfiy%E5%BA%94%E7%94%A8/" title="PySpider-爬取Shopify应用">PySpider-爬取Shopify应用</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/" title="分类于 大数据">大数据</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" title="分类于 数据可视化">数据可视化</a></div><span><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/Superset-%E5%9B%BE%E8%A1%A8%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B/" title="Superset-图表渲染流程">Superset-图表渲染流程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="分类于 数据结构">数据结构</a></div><span><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-HashMap/" title="数据结构-HashMap">数据结构-HashMap</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E5%BA%93/" title="分类于 数据库">数据库</a></div><span><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E5%BA%93/MySQL-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E4%B8%8E%E4%BC%98%E5%8C%96/" title="MySQL-基本概念与优化">MySQL-基本概念与优化</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/" title="分类于 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/IT%E8%BF%90%E7%BB%B4/" title="分类于 IT运维">IT运维</a></div><span><a href="/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/IT%E8%BF%90%E7%BB%B4/NodeJs-%E5%9C%A8%E5%90%84%E7%B3%BB%E7%BB%9F%E4%B8%8B%E5%AE%89%E8%A3%85/" title="Nodejs-在各系统安装">Nodejs-在各系统安装</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Lucas @ Lucas Home</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">230k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">3:29</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"计算机科学/大数据/数据仓库/数据仓库-一些数仓理论在工作中的理解/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->